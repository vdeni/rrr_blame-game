---
output:
    word_document
---

```{r setup, echo=F, message=F, warning=F, results='hide'}
library(here)

setwd(here::here('analyses'))

renv::activate()

library(dplyr)
library(magrittr)
library(readr)
library(glue)

knitr::opts_chunk$set(device = 'png',
                      dpi = 300,
                      echo = F,
                      message = F)

options(scipen = 5,
        digits = 3)

.financial_fine_lim_hrk <- 10200
.financial_fine_lim_usd <- 4500
```

# Methods

## Study 1a

```{r s1a-data}
d_s1a <- readr::read_csv(here('analyses',
                              'study_1a',
                              'data',
                              'clean',
                              'study_1a.csv'))

.n_start <- nrow(d_s1a)

# get count of participants who have entered values above the exclusion criterion
.gthan <- dplyr::filter(d_s1a,
                        assess_fine >= .financial_fine_lim_hrk
                            & !is.na(assess_fine)) %>%
    nrow(.)

# get count of participants who have not entered both assessments
.nas <- dplyr::filter(d_s1a,
                      is.na(assess_fine) | is.na(assess_blame)) %>%
    nrow(.)

# filter out participants who haven't provided any of the two assessments
d_s1a %<>%
    filter(.,
            !is.na(assess_fine) & !is.na(assess_blame))
```

In total, `r .n_start` people decided to participate in the study. As was
stated earlier, we have decided to exclude participants who have entered a
fine greater than or equal to `r .financial_fine_lim_hrk` HRK. None of the
participants met the exclusion criterion. However, `r .nas` participants were
excluded because they have not responded to questions regarding the assessment
of blame or the assessment of the fine. These exclusions left us
with `r nrow(d_s1a)` participants who have provided the data necessary for
the analysis. Of the `r nrow(d_s1a)` participants,
`r filter(d_s1a, experimental_situation == 'agentive') %>% nrow(.)` read the
agentive description of the event, and
`r filter(d_s1a, experimental_situation == 'nonagentive') %>% nrow(.)` read
the nonagentive description of the event.

```{r s1a-demo}
.gender <- table(d_s1a$gender)
```

The participants were students from the Faculty of Humanities and Social
Sciences of the University of Zagreb, Croatia. Of the `r nrow(d_s1a)`
participants whose data were analysed, `r .gender['woman']` declared themselves
as women, `r .gender['man']` as men, `r .gender['other']` chose "other", and
`r .gender['do not want to disclose']` chose not to disclose the information.
The median age of the participants whose data was analysed and who listed
their age was `r median(d_s1a$age, na.rm = T)` (with a range from
`r min(d_s1a$age, na.rm = T)` to `r max(d_s1a$age, na.rm = T)`).

## Study 1b

```{r s1b-data}
d_s1b <- readr::read_csv(here('analyses',
                              'study_1b',
                              'data',
                              'clean',
                              'study_1b.csv'))

.n_start <- nrow(d_s1b)

# get count of participants who have entered values above the exclusion criterion
.gthan <- dplyr::filter(d_s1b,
                        assess_fine >= .financial_fine_lim_usd
                            & !is.na(assess_fine)) %>%
    nrow(.)

# get count of participants who have not entered both assessments
.nas <- dplyr::filter(d_s1b,
                      is.na(assess_fine) | is.na(assess_blame)) %>%
    nrow(.)

# filter out participants who haven't provided any of the two assessments
d_s1b %<>%
    filter(.,
            !is.na(assess_fine) & !is.na(assess_blame))
```

In total, `r .n_start` people decided to participate in the study. As was
stated earlier, we have decided to exclude participants who have entered a
fine greater than or equal to `r .financial_fine_lim_usd` USD. One of the
participants met the exclusion criterion. Furthermore, `r .nas` participants were
excluded because they have not responded to questions regarding the assessment
of blame or the assessment of the fine. These exclusions left us
with `r nrow(d_s1b)` participants who have provided the data necessary for
the analysis. Of the `r nrow(d_s1b)` participants,
`r filter(d_s1b, experimental_situation == 'agentive') %>% nrow(.)` read the
agentive description of the event, and
`r filter(d_s1b, experimental_situation == 'nonagentive') %>% nrow(.)` read
the nonagentive description of the event.

```{r s1b-demo}
.gender <- table(d_s1b$gender)
```

The participants were recruited through Prolific.
Of the `r nrow(d_s1b)`
participants whose data were analysed, `r .gender['Female']` declared themselves
as women, `r .gender['Male']` as men, and `r .gender['Other']` chose "other".
The median age of the participants whose data was analysed and who listed
their age was `r median(d_s1b$age, na.rm = T)` (with a range from
`r min(d_s1b$age, na.rm = T)` to `r max(d_s1b$age, na.rm = T)`).

## Study 2a

```{r s2a-data}
d_s2a <- readr::read_csv(here('analyses',
                              'study_2a',
                              'data',
                              'clean',
                              'study_2a.csv'))

.n_start <- nrow(d_s2a)

# get count of participants who have entered values above the exclusion criterion
.gthan <- dplyr::filter(d_s2a,
                        assess_fine >= .financial_fine_lim_hrk
                            & !is.na(assess_fine)) %>%
    nrow(.)

# get count of participants who have not entered both assessments
.nas <- dplyr::filter(d_s2a,
                      is.na(assess_fine)) %>%
    nrow(.)

# filter out participants who haven't provided any of the two assessments
d_s2a %<>%
    filter(.,
            !is.na(assess_fine))

.partic_similar <- d_s2a %>%
    filter(.,
           recently_participated_similar %in% c(NA, 2)) %>%
    nrow(.)

d_s2a %<>%
        filter(.,
               !recently_participated_similar %in% c(NA, 2))
```

In total, `r .n_start` people decided to participate in this study. None of
the participants responded that the fine should be greater than
or equal to `r .financial_fine_lim_hrk` HRK. However, `r .nas` participants
did not state a fine, and were therefore excluded. Furthermore,
`r .partic_similar` participants stated that they have recently participated
in a similar study (or have not answered to that question), and so were also
excluded. This left us with `r nrow(d_s2a)` participants.

```{r s2a-per-group}
.group_n <- d_s2a %>%
    count(.,
          agency,
          blame_level)
```

In total, `r filter(d_s2a, agency == 'agentive') %>% nrow(.)` participants read
the agentive description of the event. Of those, 
`r filter(.group_n, agency == 'agentive') %>% glue::glue_data(.,
'{n} were assigned to blame level {blame_level}')`.
In total, `r filter(d_s2a, agency == 'nonagentive') %>% nrow(.)`
participants read the agentive description of the event. Of those, 
`r filter(.group_n, agency == 'nonagentive') %>% glue::glue_data(.,
'{n} were assigned to blame level {blame_level}')`.

```{r s2a-demo}
.gender <- table(d_s2a$gender)
```

The participants were students from the University of Zagreb, Croatia, but not
students of the Faculty of Humanities and Social Sciences.
Of the `r nrow(d_s2a)`
participants whose data were analysed, `r .gender['female']` declared themselves
as women, `r .gender['male']` as men, `r .gender['other']` chose "other",
and `r .gender['I prefer not to answer']` did not disclose any information.
The median age of the participants whose data was analysed and who listed
their age was `r median(d_s2a$age, na.rm = T)` (with a range from
`r min(d_s2a$age, na.rm = T)` to `r max(d_s2a$age, na.rm = T)`).

## Study 2b

```{r s2b-data}
d_s2b <- readr::read_csv(here('analyses',
                              'study_2b',
                              'data',
                              'clean',
                              'study_2b.csv'))

.n_start <- nrow(d_s2b)

# get count of participants who have entered values above the exclusion criterion
.gthan <- dplyr::filter(d_s2b,
                        assess_fine >= .financial_fine_lim_usd
                            & !is.na(assess_fine)) %>%
    nrow(.)

# get count of participants who have not entered both assessments
.nas <- dplyr::filter(d_s2b,
                      is.na(assess_fine)) %>%
    nrow(.)

# filter out participants who haven't provided any of the two assessments
d_s2b %<>%
    filter(.,
            !is.na(assess_fine))
```

In total, `r .n_start` people decided to participate in this study.
Of those, `r .gthan` participants responded that the fine should be greater
than or equal to `r .financial_fine_lim_usd` USD, and were therefore excluded.
Additionaly, `r .nas` participants did not state a fine, and so were excluded.
This left us with `r nrow(d_s2b)` participants.

```{r s2b-per-group}
.group_n <- d_s2b %>%
    count(.,
          agency,
          blame_level)
```

In total, `r filter(d_s2b, agency == 'agentive') %>% nrow(.)` participants read
the agentive description of the event. Of those, 
`r filter(.group_n, agency == 'agentive') %>% glue::glue_data(.,
'{n} were assigned to blame level {blame_level}')`.
In total, `r filter(d_s2b, agency == 'nonagentive') %>% nrow(.)`
participants read the agentive description of the event. Of those, 
`r filter(.group_n, agency == 'nonagentive') %>% glue::glue_data(.,
'{n} were assigned to blame level {blame_level}')`.

